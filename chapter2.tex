\chapter{ЦЕНТРАЛИЗОВАННОЕ ОПТИМАЛЬНОЕ УПРАВЛЕНИЕ}\label{chap2}


В настоящей главе рассматривается задача оптимального управления группой линейных взаимосвязанных систем. Учитываются  динамические связи между системами, т.е. состояния соседних систем влияют на динамику каждой отдельной системы, входя в правую часть дифференциального уравнения. Также учитываются статические связи, в частности, общее терминальное ограничение на состояния всех систем в терминальный момент времени. В настоящей работе рассматривается случай централизованного оптимального управления в реальном времени.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Задача оптимального управления группой динамических систем}\label{2_1}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Определим $T$ и $T_h$ как в главе~\ref{chap1}:
$$
    T = [t_0,\ t_f],\ T_h = \{t_0,~ t_0 + h, \dots ,~ t_f - h\},\ h = \dfrac{t_f - t_0}{N},\ N \in \mathbb{N}.
    $$


Пусть $I = \{1,\ 2,\ ...,\ q\}$, $I_i = I\backslash i$; $A_{ij}(t) \in \R^{n_i \times n_j}, B_{ij}(t) \in \R^{n_i \times r_j}$, $t \in T$, $i, j \in I$, --- кусочно-непрерывные матричные функции; $A_i(t) = A_{ii}(t)$, $B_i(t) = B_{ii}(t)$, $t \in T$, $i \in I$.


Составим задачу оптимального управления для группы $q$ взаимосвязанных линейных нестационарных объектов управления.


Будем считать \cite{JVM_2008}, что на промежутке $T$ модель $i$-го ($i \in I$) объекта имеет вид:
\begin{equation}\label{equation_mainModel}
\dot x_i = A_i(t) x_i + \sum_{j \in I_i} A_{ij}(t)x_j + B_i(t) u_i +
\sum_{j \in I_i} B_{ij}(t) u_j,\quad x_i(t_0) = x_{i,0},
\end{equation}
где $x_i = x_i(t) \in \R^{n_i}$ --- состояние $i$-ой математической модели; $u_i = u_i(t) \in U_i = \{u \in \R^{r_i} : u_{i*} \leq u \leq u_i^* \}$ --- дискретное управляющие воздействие $i$-ой математической модели c периодом квантования $h$ ($u_{i*}, u_i^* \in \R^{r_i}$ --- заданные векторы). Будем также считать, что $n = \sum_{i \in I_i} n_i, \ r = \sum_{i \in I_i} r_i.$ Таким образом $u \in \R^{r}$, $x \in \R^{n}$.



Функция $A_i(t), t \in T,$ характеризует собственную динамику $i$-й модели, а $B_i(t), t \in T,$ определяет её входное устройство.

Функции $A_{ij}(t), t \in T, i \in I_j$, служат для описания влияния на $i$-ую модель остальных моделей, а функции $B_{ij}(t), t \in T, i \in I_j$, --- для описания влияния на на $i$-ую модель управляющих воздействий остальных моделей.

Таким образом, объекты в рассматриваемой группе содержат динамические взаимосвязи со всеми остальными объектами.

Кроме динамических взаимосвязей будем исследовать случай статических взаимосвязей, когда связь наложена в какой-то конкретный момент времени. Таким моментом выберем терминальный момент $t_f$.

Определим терминальное множество $S$ (общее для всех объектов) в виде
\begin{equation}\label{main_terminal_limits}
x(t_f) \in S = \left\lbrace
\begin{pmatrix}
	x_1\\
	\vdots\\
	x_q\\
\end{pmatrix} \in \R^n : \sum_{i \in I} H_i x_i =g\right\rbrace,
\end{equation}
где $H_i \in \R^{m \times n_i}$, rank$(H_i) = m \le n_i, i \in I, g \in \R^m.$

В дальнейшем пусть $H = (H_1, ..., H_q)$, т.е  (\ref{main_terminal_limits}) можно записать в виде
\begin{equation}\label{main_terminal_limits_simplified}
x(t_f) \in S = \left\lbrace x: H x = g\right\rbrace,
\end{equation}


Целью управления является минимизация линейного терминального критерия качества:
\begin{equation}\label{main_quolity}
\sum_{i \in I} c_i' x_i(t_f) \to \min_{u},
\end{equation}
где $c_i \in \R^{n_i}$ --- заданные векторы.

Пусть
$c =
\begin{pmatrix}
	c_1\\
	\vdots\\
	c_q\\
\end{pmatrix},$ тогда (\ref{main_quolity}) можно записать в виде:
\begin{equation}\label{main_quolity_simplified}
c' x \to \min_{u}.
\end{equation}


Таким образом задача оптимального управления для группы $q$ взаимосвязанных линейных нестационарных объектов управления имеет вид:
\begin{equation}\label{main_task}
\sum_{i \in I} c_i' x_i(t_f) \to \min_{u},
\end{equation}
\[
\dot x_i = A_i(t) x_i + \sum_{j \in I_i} A_{ij}(t)x_j + B_i(t) u_i +
\sum_{j \in I_i} B_{ij}(t) u_j,\quad x_i(t_0) = x_{i,0}, \ i\in I,
\]
\[ \sum_{i \in I} H_i x_i(t_f) = g, \]
\[u_i(t) \in U_i, \quad t\in T, \quad i \in I.\]


Группой динамических объектов (\ref{equation_mainModel}) можно управлять централизованно и децентрализованно \cite{JVM_2016}.

\begin{figure}[h!]
  \centering
  \includegraphics[width=0.45\textwidth]{CentrControlScheme.eps}
  \includegraphics[width=0.45\textwidth]{DecControlScheme.eps}\\
  \caption{Схема централизованного и децентрализованного управления}\label{fig-2-1}
\end{figure}



В \textit{централизованном} случае (см. также главу~\ref{chap1}) имеется общий центр управления, которой на каждом промежутке времени $[ \tau, \tau + h[, \tau \in T_h$ по точной информации о состоянии $x^*(\tau) = (x_i^*(\tau), i \in I)$ группы вырабатывает управляющие воздействия $u^*(t) = (u_i^*(t), i \in I), t \in [\tau, \tau + h[, \tau \in T_h$, которое используется до тех пор, пока не будет измерено и обработано следующее состояние $x^*(\tau + h)$ .


В \textit{децентрализованном} случае каждый объект управления имеет собственный регулятор. Этот локальный регулятор для каждого $i$-го объекта по точному состоянию $x_i^*(\tau), \tau \in T_h$ своего объекта и состояниям $x_j^*(\tau - h), \tau \in T_h, j \in I_i,$ остальных объектов в предыдущий момент времени строит локальное управляющее воздействие $u_i^*(t), t \in [\tau, \tau + h[, \tau \in T_h$, которое используется до тех пор, пока не будет измерено и обработано следующее состояние $x_i^*(\tau + h)$.

В настоящей главе рассматривается случай централизованного управления.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Построение централизованной обратной связи в реальном времени}\label{2_2}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



При централизованном управлении динамическая модель (\ref{equation_mainModel}) рассматривается как одна большая система:
\begin{equation}\label{equation_BigSystem}
\dot x = A(t) x + B(t) u, \quad x(t_0) = x_0,
\end{equation}
где
$x =
\begin{pmatrix}
	x_1\\
	\vdots\\
	x_q\\
\end{pmatrix},
u =
\begin{pmatrix}
	u_1\\
	\vdots\\
	u_q\\
\end{pmatrix},
x_0 =
\begin{pmatrix}
	x_{1,0}\\
	\vdots\\
	x_{q,0}\\
\end{pmatrix}
$; $A,\ B$ --- соответствующие блочные матрицы.



Пусть имеется общий центр управления, которой для каждого момента времени $\tau \in T_h$
%на каждом промежутке времени $[ \tau, \tau + h[$,
по точной информации о состоянии группы
$$
    x^*(\tau) =
\begin{pmatrix}
	x_1^*(\tau)\\
	\vdots\\
	x_q^*(\tau)\\
\end{pmatrix}
$$
вырабатывает управляющие воздействие (текущее значение оптимальной обратной связи)
\begin{equation}\label{of}
u^*(t) =
\begin{pmatrix}
	u_1^*(t)\\
	\vdots\\
	u_q^*(t)\\
\end{pmatrix}, \ \
t \in [\tau, \tau + h[,
    \end{equation} 
которое подается на вход объекта управления до тех пор, пока не будет измерено и обработано следующее состояние $x^*(\tau + h)$.

Напомним, что такое построение оптимальной обратной связи называется ее реализацией в реальном времени. Это построение осуществляет оптимальный регулятор (см. главу 1), в данном случае --- централизованный оптимальный регулятор.

Согласно (\cite{JVM_2016}, с. 1713),  для построения реализации (\ref{of}) оптимальный регулятор решает задачу $P(\tau)$:
\[c' x(t_f) \to \min_{u},\]
\[\dot x = A(t) x + B(t) u,\]
\[x(\tau) = x^*(\tau),\]
\[H x(t_f) = g, \]
\[ u \in U,\quad t \in [\tau, t_f],\]
где $U = U_1 \times U_2 \times ... \times U_q$.

Оптимальную программу задачи $P(\tau)$ будем обозначать $u^0(t|\tau,x^*(\tau)), t \in [\tau, t_f]$.




Алгоритм построения реализации централизованной обратной связи
$u^*(\tau, x^*(\tau))$, $\tau \in T_h,$ имеет вид:

\begin{enumerate}
\item Положить $\tau = t_0, \ x^*(\tau) = x_0$.


\item Найти оптимальную программу $u^0(t|\tau,x^*(\tau)), t \in [\tau, t_f]$, задачи $P(\tau)$.

\item  Задать значение оптимальной обратной связи для позиции $(\tau,x^*(\tau))$:
\[
u^0(\tau, x^*(\tau)) = u^0(\tau|\tau,x^*(\tau)),
\]
и подать на объект управления управляющее воздействие 
\[
    u^*(t) \equiv u^*(\tau) := u^0(\tau, x^*(\tau)), \  \ t\in [\tau, \tau+h[.
\]

\item В момент $\tau + h$ измерить  $x^*(\tau + h)$, положить $\tau:= \tau+ h$, при $\tau < t_f$ вернуться к шагу 2.
\end{enumerate}

Основная трудоемкость реализации данного алгоритма приходится на шаг 2, на котором необходимо быстро (за время, не превосходящее $h$) решать задачу оптимального управления $P(\tau)$.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Решение задачи оптимального управления $P(\tau)$}\label{2_2}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


Для решения заметим, что в классе дискретных управлений задача $P(\tau)$ сводится к задаче линейного программирования. При сведении можно пользоваться  последовательным или параллельным подходами (см. главу~\ref{chap1}).


Сначала рассмотрим задачу $P(t_0, x_0)$ --- это задача построения оптимального программного решения исходной задачи оптимального управления группой. Эта задача может решаться до начала процесса управления в реальном времени, т.е. до запуска алгоритма работы оптимального регулятора.

Рассмотрим параллельный подход. Для этого запишем формулу Коши для системы в непрерывном времени:
\begin{equation} \label{formula_Cauchy}
x(t) = F(t,t_0)x_0 + \int\limits_{t_0}^t F(t,\theta)B(\theta)u(\theta)\,d\theta.
\end{equation}


Пусть $t_0 = s, s \in T_h$. Применим данную формулу для дискретного управления и подставим $t = s + h$:
\[
	x(s + h) = A_h(s)x(s) + B_h(s)u(s),
\]
где $A_h(s) = F(s+h,s), \ B_h(s) = \int\limits_{s}^{s+h} F(s+h,\theta)B(\theta)\,d\theta.$


В итоге задача (\ref{main_task}) примет вид:
\[c' x(t_f) \to \min_{u},\]
\[x(s + h) = A_h(s)x(s) + B_h(s)u(s), \ s \in T_h,\]
\[x(t_0) = x_0,\]
\[H x(t_f) = g,\]
\[ u_* \le u(s) \le u^*, \ s \in T_h, \]
где неизвестными являются $x(s), \ s \in T_h \cup t_f$ и $u(s), \ s \in T_h$.


Таким образом, при использовании параллельного подхода имеем всего
$(N + 1) n + N r$ неизвестных и $N n + m$ основных ограничений.


Рассмотрим последовательный подход. Подставим в формулу Коши (\ref{formula_Cauchy}) $t = t_f$, а получившуюся величину $x(t_f)$ подставим в исходную задачу (\ref{main_task}). Тогда (\ref{main_task}) имеет вид:
\begin{equation}\label{task_in_LP}
\sum_{s \in T_h} c_h'(s) u(s) \to \min,
\end{equation}
\[\sum_{s \in T_h} D_h(s) u(s) = \tilde g,\]
\[u_* \le u(s) \le u^*,  \ s \in T_h\,\]
где
$$
    c_h'(s) = \int\limits_{s}^{s+h} c' F(t_f,\theta)B(\theta)\,d\theta,\ c_h(s) \in \R^{r},
     $$
$$
    D_h(s) = \int\limits_{s}^{s+h} H F(t_f,\theta)B(\theta)\,d\theta,\  D_h(s) \in \R^{m \times r};
    $$
$$
    \tilde g = g - H F(t_f, t_0)x_0.
    $$


В итоге при использовании последовательного подхода имеем всего $Nr$ неизвестных и $m$ основных ограничений.


Таким образом, при применении параллельного подхода получается задача линейного программирования большей размерности. Однако при этом матрица основных ограничений имеет специальную структуру, является разреженной (содержит большое количество нулей). Для ее решения применяют методы линейного программирования, которые способны учитывать разреженность матрицы для ускорения работы метода.

При последовательном подходе матрица основных ограничений плотнозаполненная. Но в ней тоже можно выделить специальную динамическую структуру --- соседние столбцы при малых $h$ почти коллинеарны, а в базис (опору) задачи оптимального управления войдут те столбцы, в которых находятся нули коуправления. В работе \cite{JVM_2000} выделена такая структура и предложен специальный метод решения задачи оптимального управления на основе задачи линейного программирования (\ref{task_in_LP}). Последняя называется функциональной формой задачи оптимального управления $P$.

В настоящей работе при реализации алгоритма работы оптимального регулятора на шаге 2 используется решение на основе функциональной формы. Для задачи $P(\tau)$ она имеет вид
\begin{equation}\label{Ptau}
\sum_{s \in T_h(\tau)} c_h'(s) u(s) \to \min,
\end{equation}
\[\sum_{s \in T_h(\tau)} D_h(s) u(s) = \tilde g(\tau),\]
\[u_* \le u(s) \le u^*,  \ s \in T_h(\tau),\]
где $T_h(\tau) = [\tau, t_f] \cap T_h$;
$
    \tilde g = g - H F(t_f, \tau) x^*(\tau).
    $

\bigskip

Таким образом, в настоящей главе сформулирована задача оптимального управления группой линейных взаимосвязанных систем и  описаны два принципа управления группой --- централизованный и децентрализованный. Исследован централизованный принцип: предложен алгоритм работы централизованного оптимального регулятора, приведены два подхода для сведения централизованной задачи оптимального управления к задаче линейного программирования.


