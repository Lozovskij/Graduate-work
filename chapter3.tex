\chapter{ДЕЦЕНТРАЛИЗОВАННОЕ ОПТИМАЛЬНОЕ УПРАВЛЕНИЕ}\label{chap3}

В настоящей главе, как и в предыдущей, рассматривается задача оптимального управления группой линейных взаимосвязанных систем. Как и раньше, учитываются  динамические и статические связи между системами, оптимальное управление строится в реальном времени, однако теперь оно строится не централизованно, а децентрализованно.

\section{Задача оптимального децентрализованного управления группой динамических систем}\label{3_1}

Введем обозначения аналогичные тем, что были в главе 2:

$ T = [t_0,\ t_f],\ T_h = \{t_0,~ t_0 + h, \dots ,~ t_f - h\},\ h = \dfrac{t_f - t_0}{N},\ N \in \mathbb{N}$, $I = \{1,\ 2,\ ...,\ q\},\ I_i = I\backslash i$; 

$A_{ij}(t) \in \R^{n_i \times n_j}, \ B_{ij}(t) \in \R^{n_i \times r_j},\ t \in T$, $i, j \in I$, --- кусочно-непрерывные матричные функции; $A_i(t) = A_{ii}(t)$, $B_i(t) = B_{ii}(t)$, $t \in T$, $i \in I.$
	
$x_i = x_i(t) \in \R^{n_i}$ --- состояние $i$-ой математической модели; $u_i = u_i(t) \in U_i = \{u \in \R^{r_i} : u_{i*} \leq u \leq u_i^* \}$ --- дискретное управляющие воздействие $i$-ой математической модели c периодом квантования $h$ ($u_{i*}, u_i^* \in \R^{r_i}$ --- заданные векторы). Будем также считать, что $n = \sum_{i \in I_i} n_i, \ r = \sum_{i \in I_i} r_i.$ Таким образом $u \in \R^{r}$, $x \in \R^{n}$.

Как и в главе 2, будем считать \cite{JVM_2008}, что на промежутке $T$ модель $i$-го ($i \in I$) объекта имеет вид:
\begin{equation}\label{equation_mainModel_dec}
\dot x_i = A_i(t) x_i + \sum_{j \in I_i} A_{ij}(t)x_j + B_i(t) u_i +
\sum_{j \in I_i} B_{ij}(t) u_j,\quad x_i(t_0) = x_{i,0}.
\end{equation}

Терминальное множество $S$ (общее для всех объектов):
\begin{equation}\label{main_terminal_limits_dec}
x(t_f) \in S = \left\lbrace
\begin{pmatrix}
	x_1\\
	\vdots\\
	x_q\\
\end{pmatrix} \in \R^n : \sum_{i \in I} H_i x_i =g\right\rbrace,
\end{equation}
где $H_i \in \R^{m \times n_i}$, rank$(H_i) = m \le n_i, i \in I, g \in \R^m.$

(\ref{main_terminal_limits_dec}) можно записать в виде:
\begin{equation}\label{main_terminal_limits_simplified_dec}
x(t_f) \in S = \left\lbrace x: H x = g\right\rbrace,
\end{equation}
где $H = (H_1, ..., H_q)$

Линейный терминальный критерий качества:
\begin{equation}\label{main_quolity_dec}
\sum_{i \in I} c_i' x_i(t_f) \to \min_{u},
\end{equation}
где $c_i \in \R^{n_i}$ --- заданные векторы.

(\ref{main_quolity_dec}) можно записать в виде:
\begin{equation}\label{main_quolity_simplified_dec}
c' x \to \min_{u},
\end{equation}
где
$c =
\begin{pmatrix}
	c_1\\
	\vdots\\
	c_q\\
\end{pmatrix}.$

В итоге задача принимает вид:
\begin{equation}\label{main_task_dec}
\sum_{i \in I} c_i' x_i(t_f) \to \min_{u},
\end{equation}
\[
\dot x_i = A_i(t) x_i + \sum_{j \in I_i} A_{ij}(t)x_j + B_i(t) u_i +
\sum_{j \in I_i} B_{ij}(t) u_j,
\]
\[
 x_i(t_0) = x_{i,0}, \ i\in I,
\]
\[ \sum_{i \in I} H_i x_i(t_f) = g, \]
\[u_i(t) \in U_i, \quad t\in T, \quad i \in I.\]


Таким образом, задача осталась преждней, но теперь она исопользуется для определения программного решения перед процессом управления, оно поступает на вход объектов управления на интервале $[t_0, \ t_0 + h)$.



\section{Построение децентрализованной обратной связи в реальном времени}\label{3_2}

Как было отмечено в предыдущей главе, в \textit{децентрализованном} случае каждый объект управления имеет собственный регулятор. Этот локальный регулятор для каждого $i$-го объекта по точному состоянию $x_i^*(\tau), \ \tau \in T_h$ своего объекта и состояниям $x_j^*(\tau - h), \ \tau \in T_h, \ j \in I_i,$ остальных объектов в предыдущий момент времени строит локальное управляющее воздействие $u_i^*(t), \ t \in [\tau, \ \tau + h), \ \tau \in T_h$, которое используется до тех пор, пока не будет измерено и обработано следующее состояние $x_i^*(\tau + h)$.

Для определения управления, которое будет использоваться регулятором на первом шаге, будем считать, что имеется единый центр, который до начала процесса управления способен по априорной информации вычислить оптимальную программу. Вообще не обязательно наличие такого центра, регуляторы сами могли бы вычислить оптимальную программу. То есть таким центром мог бы быть один из регуляторов.

Будем также считать, что при получении входных данных, регулятор строит управление мгновенно, то есть это время, время построения управления, в численных экспериментах учитываться не будет.

Таким образом, пусть для всей группы перед началом процесса управления единым центром решается задача (\ref{main_task_dec}), которая была собрана в предыдущем пункте.

Программное решение $u_i^0(t),\ t \in T$ задачи (\ref{main_task_dec}) может строиться так, как это было описано ранее в централизованном случае. После построения данное управление поступает на вход объектов управления на интервале $[t_0, \ t_0 + h)$. То есть реализация оптимальное обратной связи $u^*_i(t) = u_i^0(t_0) \equiv u_i^0(t_0| \ t_0, \ x_i^*(t_0))$.

Обозначим через $u_i^0(t \ | \ \tau, x(\tau)), \ t \in T, \ \tau \in T_h$ программное решение для позиции $(\tau, \ x(\tau))$. Также пусть $u_i^0(t \ | \ \tau, \ x_i(\tau), \ x(\tau - h)), \ t \in T, \ \tau \in T_h$ -- программное решение, построенное по априорной позиции, вычисленной по указанным точным значениям $x_i(\tau) \in R^{n_i}, \ x(\tau - h)\in R^{n}$.

Чтобы определить в процессе управления в момент $\tau \in T_h/t_0$ текущее значение управляющего воздействия $u_i^*(\tau)$, $i$-й регулятор строит программное решение $u_i^0(t\ | \ \tau, \ x_i^*(\tau), \ x^*(\tau - h)), \ t \in T(\tau) = [\tau, \ t_f]$, решив вспомогательную задачу $P_i(\tau)$:

\begin{equation}\label{regulator_task}
\sum_{k \in I} c_k' x_k(t_f) \to \min_{u_i},
\end{equation}
\[
\dot x_i = A_i(t) x_i + \sum_{j \in I_i} A_{ij}(t)x_j + B_i(t) u_i +
f_i^0(t| \tau),\quad x_i(\tau) = x_i^*(\tau),
\]
\[
\dot x_k = A_k(t) x_k + \sum_{j \in I_k} A_{kj}(t)x_j + B_{ki}(t) u_i +
f_{ki}^0(t| \tau),\quad x_k(\tau) = x_k^0(\tau), \ k\in I_i,
\]
\[ \sum_{i \in I} H_i x_i(t_f) = g, \quad u_i(t) \in U_i, \quad t\in T(\tau), \quad i \in I.\]

Тут звездочка в состояниях говорит о том, что они измерены точно, а не априорно. Для того, чтобы показать, что состояние посчитано априорно, используется обозначение вида $x_i^0(\tau)$.

В (\ref{regulator_task}) функции $f_i^0(t| \tau), $ и $f_{ki}^0(t| \tau), \  t\in T(\tau), \ k \in I_i, $ имеют вид
\[
f_i^0(t| \tau) = f_i^0(t), \quad f_{ki}^0(t| \tau) = f_{ki}^0(t),\quad \tau = t_0 + h,
\]
\[
f_i^0(t| \tau) = \sum_{j \in I_i}B_{ij}(t)u^0_j(t|\tau-h, \ x_j^*(\tau - h), \ x^*(\tau - 2h)),
\]
\[
f_{ki}^0(t| \tau) = \sum_{j \in I_i}B_{kj}(t)u^0_j(t|\tau-h, \ x_j^*(\tau - h), \ x^*(\tau - 2h)), \quad \tau \in T_h \backslash \{t_0, t_0 + h\},
\]
где $u^0_j(t|\tau-h, \ x_j^*(\tau - h), \ x^*(\tau - 2h)), t \in T(\tau), j \in I_i,$-- оптимальные программы, посчитанные $j$-ми регуляторами на предыдущем шаге.

Таким образом, реализацию оптимальной обратной связи $i$-го объекта можно записать в виде:
\[ 
u_i^*(t) = 
	\left\{
	\begin{array}{ll}
		u_i^0(t_0), \quad t \in [t_0, \ t_0 + h),\\
		u_i^0(\tau \ | \ \tau, \ x_i^*(\tau), \ x^*(\tau - h)), \ t \in 		[\tau, \ \tau + h), \ \tau \in T_h/t_0.
	\end{array} 
	\right. 
\]

Алгоритм построения реализации оптимальной обратной связи $u_i^*(t), \ t \in T, \ i \in I$ для случая децентрализованного оптимального управления имеет вид:

\begin{enumerate}

\item Найти оптимальную программу $u^0(t), \ t \in T$, задачи (\ref{main_task_dec}).

\item Измерить  $x_i^*(\tau + h)$ и вычислить $x_k^0(\tau + h), \ k\in I_i$.

\item  Задать значение оптимальной обратной связи для позиции $(t_0,x^*(t_0))$:
\[
u^0(t_0, \ x^*(t_0)) = u^0(t_0),
\]
и подать на объект управления управляющее воздействие 
\[
    u_i^*(t) \equiv u_i^*(t_0) := u_i^0(t_0, \ x^*(t_0)), \  \ t\in [t_0, \  t_0+h).
\]

\item Положить $\tau = t_0 + h, \ x_k(\tau) = x_k^0(\tau), \ k\in I_i, \  x_i(\tau) = x_i^*(\tau)$.

\item Найти оптимальную программу $u_i^0(t|\tau, \ x_i^*(\tau), \ x^*(\tau - h)), \ t\in [\tau, \ t_f],$ задачи $P_i(\tau)$.

\item  Задать значение оптимальной обратной связи для позиции $(\tau,x(\tau))$:
\[
u_i^0(\tau, x(\tau)) = u_i^0(\tau|\tau, \ x_i^*(\tau), \ x^*(\tau - h)),
\]
и подать на объект управления управляющее воздействие 
\[
    u_i^*(t) \equiv u_i^*(\tau) := u_i^0(\tau, x(\tau)), \ \ t\in [\tau, \ \tau+h).
\]

\item В момент $\tau + h$ измерить  $x_i^*(\tau + h)$ и вычислить  $x_k^0(\tau + h), \ k\in I_i$, положить $\tau:= \tau+ h$, при $\tau < t_f$ вернуться к шагу 5.
\end{enumerate}

Основная трудоемкость реализации данного алгоритма приходится на шаг 5, на котором необходимо быстро (за время, не превосходящее $h$) решать задачу оптимального управления $P_i(\tau)$.

В качестве обоснования применимости и указанной схемы и алгоритма для решения децентрализованной задачи (\ref{main_task_dec}) используется утверждение: 
....

\section{Решение задачи оптимального управления $P_i(\tau)$}\label{3_3}
Перед решением задачи $P_i(\tau), \ \tau \in T_h\backslash t_0$ необходимо вычислить начальные состаяния $x_j^0(\tau), \ j\in I_i$, так как эти состояния используются при определении данной задачи. Для вычисления этих начальных состаяний достаточно знать обратные связи  
$$
u_j^0(\tau - h, x(\tau - h)) := u^0_j(\tau - h|\tau-h, \ x_j^*(\tau - h), \ x^*(\tau - 2h)), \ j\in I, \ \tau \in T_h
$$ 
и состояние системы $x^*(\tau - h)$ предыдущего шага $\tau - h$. Зная обратные связи и состояния можно применить формулу Коши:
\[
x(t) = F(t - t_0)x_0 + \int\limits_{t_0}^t F(t - \theta)B(\theta)u(\theta)\,d\theta.
\]

Применим формулу Коши при $t_0 = \tau - h, \ t =  \tau$:
\[
x(\tau) = F(h)(\tau - h) + \int\limits_{\tau - h}^{\tau} F(\tau - \theta)B(\theta)\,d\theta\,u(\tau - h).
\]

Для решения задачи $P_i(\tau), \ \tau \in T_h\backslash t_0$ заметим, что в классе дискретных управлений она сводится к задаче линейного программирования. Для этого можно применять последовательный или параллельный подход. Как и для централизованной задачи, используем последовательный подход, а раз формы задач совпадают, то и результат сведения остается преждним. Иными словами исходная задача (\ref{main_task_dec}) принимает вид:

\begin{equation}\label{task_in_LP_dec}
\sum_{s \in T_h} c_h'(s) u(s) \to \min,
\end{equation}
\[\sum_{s \in T_h} D_h(s) u(s) = \tilde g,\]
\[u_* \le u(s) \le u^*,  \ s \in T_h\,\]
где
$$
    c_h'(s) = \int\limits_{s}^{s+h} c' F(t_f,\theta)B(\theta)\,d\theta,\ c_h(s) \in \R^{r},
     $$
$$
    D_h(s) = \int\limits_{s}^{s+h} H F(t_f,\theta)B(\theta)\,d\theta,\  D_h(s) \in \R^{m \times r};
    $$
$$
    \tilde g = g - H F(t_f, t_0)x_0.
    $$

При реализации алгоритма работы оптимального регулятора на шаге 5 используется решение на основе функциональной формы. 
Для задачи $P_i(\tau), \ \tau \in T_h\backslash t_0$ она имеет вид:
\begin{equation}\label{P_i_tau}
\sum_{s \in T_h(\tau)} c_h'(s) u(s) \to \min,
\end{equation}
\[\sum_{s \in T_h(\tau)} D_h(s) u(s) = \tilde g(\tau),\]
\[u_j(s) = u_j(s - h), \ j\in I_i \ s \in T_h(\tau),\]
\[u_* \le u(s) \le u^*,  \ s \in T_h(\tau),\]
\[\tau \in T_h\backslash t_0,\]
где $T_h(\tau) = [\tau, t_f] \cap T_h$;
$
    \tilde g = g - H F(t_f, \tau) x^*(\tau).
    $

Задача (\ref{P_i_tau}) отличается от задачи для $P(\tau)$ наличием дополнительных условий для управлений, которые определяют значения всех управлений кроме $i$-го, а также тем, что она не применяется для $\tau = t_0$, что соответствует требованиям алгоритма построения реализации оптимальной обратной связи, где задача $P_i(\tau)$ решается начиная с момента $\tau = t_0 + h$.

\bigskip
Таким образом, обозначена задача децентрализованного оптимального управления группой, указана схема для построения децентрализованной обратной связи в реальном времени, для раскрытия схемы расписан алгоритм построения реализации оптимальной обратной связи, дано обоснования её применимости, кроме того был предложен вариант построения задачи $P_i(\tau)$ для нахождения оптимального программного решения и показано дальнейшее сведение $P_i(\tau)$ к функциональной форме.